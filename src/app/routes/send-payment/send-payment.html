<template>
    <require from="./memo-select/memo-select"></require>
    <div class="send-payment">
        <div class="card" collapsible-card="is-open:true">
            <div class="card-content">
                <div class="card-heading">
                    <div class="card-title">
                        Send Payment
                    </div>
                </div>
                <div class="card-body">
                    <!--<div if.bind="destination === lupoexPublicKey" class="card alert alert-warning center-text">
                        Hey, that looks like our address. Thanks in advance for the donation.&nbsp;<i class="fa fa-smile-o fa-lg"></i>
                    </div>-->

                    <alert config.bind="alertConfig"></alert>

                    <div class="form-container">

                        <div show.bind="step==='input'" class="input-step">
                            <div class="row">
                                <div class="col s12">
                                    <label>Code</label>
                                    <input type="text" value.bind="code" required title="Code"
                                           tt-validate="manager.bind: validationManager; key: code;">
                                </div>
                                <div class="col s12" if.bind="code !== nativeAssetCode">
                                    <label>Issuer</label>
                                    <input type="text" value.bind="issuer" required title="Issuer"
                                           tt-validate="manager.bind: validationManager; key: issuer;">
                                </div>
                                <div class="col s12">
                                    <label>Amount</label>
                                    <input stellar-compliant-float type="number" value.bind="amount" required title="Amount"
                                           tt-validate="manager.bind: validationManager; key: amount;">
                                </div>
                                <div class="col s12">
                                    <label>Destination Account</label>
                                    <stellar-address-input public-key.bind="destination" required title="Destination Account" memo.bind="requiredMemo" memo-type.bind="requiredMemoType"
                                                           tt-validate="manager.bind: validationManager; key: destination; element-selector: :input; value-prop: publicKey"></stellar-address-input>
                                </div>
                            </div>

                            <div class="accent-text" show.bind="requiredMemo">
                                <div class="card alert alert-info">
                                    <strong>
                                        <i class="fa fa-info-circle primary-text"></i>
                                    </strong>
                                    <span>
                                        You entered a federated destination address which requires a specific memo to be submitted along with the transaction.
                                        <br>
                                        When you submit your payment, the memo:
                                        <br>
                                        <strong>${requiredMemo} (type ${requiredMemoType})</strong>
                                        <br>
                                        will be included automatically.
                                    </span>
                                </div>
                            </div>

                            <div show.bind="!requiredMemo">
                                <div class="row" if.bind="memo">
                                    <br>
                                    <div class="col s12">
                                        <h6>Memo:</h6>
                                    </div>
                                    <div class="col s12">
                                        <div class="row">
                                            <div class="col s10">
                                                <memo-select validation-manager.bind="validationManager" type.bind="memo.type" value.bind="memo.value"></memo-select>
                                            </div>
                                            <div class="col s2" style="padding-top: 20px;">
                                                <button class="btn btn-small error">
                                                    <i class="fa fa-2x fa-trash-o" click.trigger="removeMemo()"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <button md-waves type="button" class="btn btn-flat accent btn-small" click.trigger="addMemo()" if.bind="!memo">
                                    <i class="fa fa-plus"></i>&nbsp;Add Memo
                                </button>
                            </div>

                            <br>
                            <br>
                            <div class="center-text">
                                <button md-waves class="btn primary" click.delegate="submitInput()">
                                    <i class="fa fa-paper-plane-o"></i>&nbsp;Submit Payment
                                </button>
                            </div>
                        </div>
                        <div show.bind="step==='confirm'" class="confirm-step">
                            <alert config.bind="confirmInfoAlertConfig"></alert>
                            <table>
                                <tr>
                                    <td class="label">Code</td>
                                    <td class="value">${code}</td>
                                </tr>
                                <tr>
                                    <td class="label">Issuer</td>
                                    <td class="value">${code === nativeAssetCode ? 'Native' : issuer}</td>
                                </tr>
                                <tr>
                                    <td class="label">Amount</td>
                                    <td class="value">${amount}</td>
                                </tr>
                                <tr>
                                    <td class="label">Destination</td>
                                    <td class="value">${destination}</td>
                                </tr>
                            </table>
                            <div class="row" show.bind="memo">
                                <br>
                                <div class="col s12">
                                    <h6>Memo:</h6>
                                </div>

                                <div class="col s12">
                                    <table>
                                        <tr>
                                            <td class="label">${memo.type}</td>
                                            <td class="value">${memo.value}</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="center-text">
                                <button md-waves class="btn gray" click.delegate="step = 'input'">
                                    <i class="fa fa-arrow-left"></i>&nbsp;Back
                                </button>
                                <button md-waves type="button" class="btn primary" click.trigger="submitConfirmation()">
                                    <i class="fa fa-check"></i>&nbsp;Confirm
                                </button>
                            </div>
                        </div>
                    </div>
                    <spinner-overlay show.bind="loading > 0"></spinner-overlay>
                </div>
            </div>
        </div>
    </div>
</template>
